<!doctype html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Weather PWA</title>

        <style>
            svg {
                width: 2rem;
                height: 2rem;
            }

            circle {
                fill: none;
                stroke: #000;
                stroke-width: 0.25rem;
                -webkit-animation: line 1.6s cubic-bezier(0.4, 0, 0.2, 1) infinite, rotate 1.6s linear infinite;
                        animation: line 1.6s cubic-bezier(0.4, 0, 0.2, 1) infinite, rotate 1.6s linear infinite;
                -webkit-transform-origin: 50%;
                        transform-origin: 50%;
            }

            @-webkit-keyframes line {
                0% {
                    stroke-dasharray: 2, 85.964;
                    -webkit-transform: rotate(0);
                }

                50% {
                    stroke-dasharray: 66.973, 21.9911;
                    stroke-dashoffset: 0;
                }

                100% {
                    stroke-dasharray: 2, 85.964;
                    stroke-dashoffset: -65.973;
                    -webkit-transform: rotate(90deg);
                }
            }

            @keyframes line {
                0% {
                    stroke-dasharray: 2, 85.964;
                    transform: rotate(0);
                }

                50% {
                    stroke-dasharray: 66.973, 21.9911;
                    stroke-dashoffset: 0;
                }

                100% {
                    stroke-dasharray: 2, 85.964;
                    stroke-dashoffset: -65.973;
                    transform: rotate(90deg);
                }
            }

            @-webkit-keyframes rotate {
                0% {
                    -webkit-transform: rotate(0);
                }

                100% {
                    -webkit-transform: rotate(450deg);
                }
            }

            @keyframes rotate {
                0% {
                    transform: rotate(0);
                }

                100% {
                    transform: rotate(450deg);
                }
            }
        </style>
    </head>

    <body>
        <header>
            <h1>Weather PWA</h1>
        </header>

        <main>
            <section class="card">
                <h2 class="location"></h2>
                <div class="date"></div>
                <div class="description"></div>
                <div class="temperature">
                    <span class="value"></span><span class="scale">°F</span>
                </div>
                <div class="humidity">
                    Humidity: <span class="value"></span><span class="scale">%</span>
                </div>
                <div class="wind">
                    Wind:
                    <span class="speed"></span><span class="scale">mpH</span>
                    <span class="direction"></span><span class="scale">°</span>
                </div>
                <div class="sunrise">
                    Sunrise: <span class="value"></span>
                </div>
                <div class="sunset">
                    Sunset: <span class="value"></span>
                </div>
            </section>

            <div class="loading-indicator">
                <svg xmlns="http://www.w3.org/2000/svg">
                    <circle cx="16" cy="16" r="14"></circle>
                </svg>
            </div>
        </main>

        <script>
            const app = {
                isLoading: true,
                loadingIndicator: document.querySelector('.loading-indicator'),
                card: document.querySelector('.card'),

                updateForecastCard: function(weather) {
                    const current = weather.channel.item.condition;
                    const wind = weather.channel.wind;
                    const astronomy = weather.channel.astronomy;

                    this.card.querySelector('.location').textContent = weather.label;
                    this.card.querySelector('.date').textContent = current.date;
                    this.card.querySelector('.description').textContent = current.text;
                    this.card.querySelector('.temperature .value').textContent = current.temp;
                    this.card.querySelector('.humidity .value').textContent = weather.channel.atmosphere.humidity;
                    this.card.querySelector('.wind .speed').textContent = wind.speed;
                    this.card.querySelector('.wind .direction').textContent = wind.direction;
                    this.card.querySelector('.sunrise .value').textContent = astronomy.sunrise;
                    this.card.querySelector('.sunset .value').textContent = astronomy.sunset;

                    if (this.isLoading) {
                        this.loadingIndicator.setAttribute('hidden', 'true');
                        this.isLoading = false;
                    }
                }
            };

            /**
             * Fake weather data
             */
            const fakeWeather = {
                label: 'New York, NY',
                channel: {
                    wind: {
                        direction: '195',
                        speed: '25'
                    },
                    atmosphere: {
                        humidity: '56'
                    },
                    astronomy: {
                        sunrise: '5:43 am',
                        sunset: '8:21 pm'
                    },
                    item: {
                        condition: {
                            code: '24',
                            date: 'Thu, 21 Jul 2016 09:00 PM EDT',
                            temp: '56',
                            text: 'Windy'
                        }
                    }
                }
            };

            // Test app with fake data
            app.updateForecastCard(fakeWeather);
        </script>
    </body>
</html>
